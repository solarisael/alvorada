@reference "tailwindcss";
@reference "../utils.css";
@reference "@catppuccin/tailwindcss/mocha.css";

@property --cursor_x {
  syntax: "<length-percentage>";
  inherits: true;
  initial-value: 50%;
}

@property --cursor_y {
  syntax: "<length-percentage>";
  inherits: true;
  initial-value: 50%;
}

#desktop-nav {
  --cursor_x: 50%;
  --cursor_y: 50%;

  --rail_background: color-mix(
    in oklch,
    var(--ui_bg_mantle) calc(78% * var(--site_shell_surface_mult, 1)),
    transparent
  );
  --rail_border: color-mix(
    in oklch,
    var(--site_style_accent) calc(42% * var(--site_style_strength_mult, 1)),
    transparent
  );
  --rail_shadow: 0 18px 45px -26px rgb(0 0 0 / 0.82);
  --rail_glass_blur: calc(10px * var(--site_shell_blur_mult, 1));
  --rail_light_opacity: 0.16;

  --pill_background: color-mix(
    in oklch,
    var(--ui_surface_soft) calc(62% * var(--site_shell_surface_mult, 1)),
    transparent
  );
  --pill_border: color-mix(
    in oklch,
    var(--site_style_accent) calc(24% * var(--site_style_strength_mult, 1)),
    transparent
  );
  --pill_text: color-mix(in oklch, var(--ui_text_primary) 88%, white);
  --pill_glow_scale: var(--site_fx_glow_mult, 1);
  --pill_transition: calc(260ms * var(--site_fx_motion_mult, 1));
  --pill_active_tint_mix: 88%;
  --pill_active_tint_target: white;
  --pill_active_border_mix: 32%;
  --pill_active_glow_strength: 0.22;

  --center_shell_border: color-mix(
    in oklch,
    var(--site_style_accent) calc(68% * var(--site_style_strength_mult, 1)),
    transparent
  );
  --center_shell_glow: color-mix(
    in oklch,
    var(--site_style_accent) calc(50% * var(--site_shell_glow_mult, 1)),
    transparent
  );
  --center_core_background: color-mix(
    in oklch,
    var(--ui_bg_crust) calc(100% * var(--site_shell_surface_mult, 1)),
    transparent
  );
  --center_ring_size: 6.5rem;
  --center_core_size: 6rem;

  @apply pointer-events-none fixed top-8 z-50;
  @apply flex w-full justify-center;
  @apply px-2;

  transform: translate3d(0, 0, 0);
  opacity: 1;
  will-change: transform, opacity;
  transition:
    transform 280ms cubic-bezier(0.22, 0.61, 0.36, 1),
    opacity 220ms ease;
}

#desktop-nav.is-nav-hidden {
  transform: translate3d(0, calc(-100% - 1.25rem), 0);
  opacity: 0;
  pointer-events: none;
}

#desktop-nav:focus-within {
  transform: translate3d(0, 0, 0);
  opacity: 1;
  pointer-events: auto;
}

#desktop-nav.navbar-preset-soft {
  --rail_glass_blur: calc(10px * var(--site_shell_blur_mult, 1));
  --rail_light_opacity: 0.14;
  --pill_glow_scale: calc(0.85 * var(--site_fx_glow_mult, 1));
}

#desktop-nav.navbar-preset-rich {
  --rail_glass_blur: calc(20px * var(--site_shell_blur_mult, 1));
  --rail_light_opacity: 0.26;
  --pill_glow_scale: calc(1.25 * var(--site_fx_glow_mult, 1));
}

#desktop-nav.route-active-tone-subtle {
  --pill_active_tint_mix: 94%;
  --pill_active_tint_target: color-mix(
    in oklch,
    var(--ui_surface_raised) 72%,
    var(--neon_color)
  );
  --pill_active_border_mix: 26%;
  --pill_active_glow_strength: 0.18;
}

#desktop-nav.route-active-tone-medium {
  --pill_active_tint_mix: 86%;
  --pill_active_tint_target: color-mix(in oklch, white 45%, var(--neon_color));
  --pill_active_border_mix: 36%;
  --pill_active_glow_strength: 0.24;
}

#desktop-nav.route-active-tone-strong {
  --pill_active_tint_mix: 78%;
  --pill_active_tint_target: color-mix(in oklch, white 32%, var(--neon_color));
  --pill_active_border_mix: 44%;
  --pill_active_glow_strength: 0.3;
}

#nav-user-bar {
  --cursor_follow_transition: 240ms;
  --cursor_recenter_transition: 1200ms;
  --cursor_transition_duration: var(--cursor_recenter_transition);

  @apply pointer-events-auto relative;
  @apply flex items-center justify-between;
  @apply h-18 w-full max-w-230;
  @apply rounded-full px-4 py-2 md:px-6 md:py-2;
  @apply border;

  border-color: var(--rail_border);
  background: linear-gradient(
    140deg,
    color-mix(in oklch, var(--rail_background) 85%, white) 0%,
    color-mix(in oklch, var(--rail_background) 72%, transparent) 42%,
    color-mix(in oklch, var(--rail_background) 92%, black) 100%
  );
  box-shadow: var(--rail_shadow);
  backdrop-filter: blur(var(--rail_glass_blur));
  transition:
    --cursor_x var(--cursor_transition_duration)
      cubic-bezier(0.22, 0.61, 0.36, 1),
    --cursor_y var(--cursor_transition_duration)
      cubic-bezier(0.22, 0.61, 0.36, 1);
}

#nav-user-bar.is-pointer-active {
  --cursor_transition_duration: var(--cursor_follow_transition);
}

#nav-user-bar::before {
  content: "";

  @apply pointer-events-none absolute rounded-full;

  inset: -2px;
  padding: 2px;

  background: radial-gradient(
    230px circle at var(--cursor_x) var(--cursor_y),
    color-mix(in oklch, var(--site_style_accent) 48%, transparent)
      calc(var(--rail_light_opacity) * 100%),
    transparent 68%
  );
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  mask-composite: exclude;
  opacity: 0.72;
}

.nav-links {
  @apply relative z-30 flex items-center;
  @apply gap-2 md:gap-3;
  @apply min-w-0;
}

#middle-guy {
  @apply w-20;
}

.nav-pill {
  --pill_pointer_glow: 0;
  --pill_active_glow: 0;
  --pill_effective_glow: max(var(--pill_pointer_glow), var(--pill_active_glow));
  --neon_color: color-mix(
    in oklch,
    var(--site_style_accent_alt) 45%,
    transparent
  );

  @apply relative;
  @apply inline-flex items-center justify-center;
  @apply rounded-full px-4 py-2;
  @apply text-sm md:text-base;
  @apply border;

  border-color: var(--pill_border);
  color: var(--pill_text);
  background-color: var(--pill_background);
  --neon-color: var(--neon_color);

  box-shadow:
    inset 0 1px 0 rgb(255 255 255 / 0.16),
    0 8px 20px -18px rgb(0 0 0 / 0.9),
    0 0 calc(16px * var(--pill_effective_glow) * var(--pill_glow_scale))
      color-mix(in oklch, var(--neon_color) 58%, transparent);
  transition:
    transform var(--pill_transition) ease,
    box-shadow var(--pill_transition) ease,
    border-color var(--pill_transition) ease,
    background-color var(--pill_transition) ease;
}

.nav-pill::before {
  content: "~/";

  @apply mr-1;
  @apply text-xs;

  color: color-mix(in oklch, var(--ui_text_muted) 88%, transparent);
  transition:
    color var(--pill_transition) ease,
    text-shadow var(--pill_transition) ease;
}

.nav-pill::after {
  content: "";

  @apply pointer-events-none absolute inset-0 rounded-full;
  @apply border;

  border-color: color-mix(in oklch, var(--neon_color) 76%, transparent);
  opacity: calc(var(--pill_effective_glow) * 0.68);
  transition: opacity var(--pill_transition) ease;
}

.nav-pill.is-route-active {
  --pill_active_glow: var(--pill_active_glow_strength);

  border-color: color-mix(
    in oklch,
    var(--neon_color) var(--pill_active_border_mix),
    var(--pill_border)
  );
  background-color: color-mix(
    in oklch,
    var(--pill_background) var(--pill_active_tint_mix),
    var(--pill_active_tint_target)
  );
  box-shadow:
    inset 0 1px 0 rgb(255 255 255 / 0.2),
    0 9px 22px -20px rgb(0 0 0 / 0.95),
    0 0 calc(18px * var(--pill_glow_scale))
      color-mix(in oklch, var(--neon_color) 48%, transparent);
}

.nav-pill.is-route-active::before {
  color: color-mix(in oklch, var(--neon_color) 46%, var(--ui_text_muted));
}

.nav-pill:hover,
.nav-pill:focus-visible {
  @apply outline-none;

  transform: translateY(calc(-1px * var(--site_fx_lift_mult, 1)));
  border-color: color-mix(in oklch, var(--neon_color) 42%, var(--pill_border));
  background-color: var(--pill_background);
  box-shadow:
    inset 0 1px 0 rgb(255 255 255 / 0.2),
    0 10px 24px -20px rgb(0 0 0 / 0.95),
    0 0
      calc(22px * (0.14 + var(--pill_effective_glow)) * var(--pill_glow_scale))
      color-mix(in oklch, var(--neon_color) 68%, transparent);
}

.nav-pill:hover::before,
.nav-pill:focus-visible::before {
  color: color-mix(in oklch, var(--neon_color) 58%, var(--ui_text_muted));
  text-shadow:
    0 0 8px color-mix(in oklch, var(--neon_color) 58%, transparent),
    0 0 14px color-mix(in oklch, var(--neon_color) 40%, transparent);
}

.nav-pill[data-phase="nigredo"] {
  --neon_color: var(--color-nigredo);
}

.nav-pill[data-phase="albedo"] {
  --neon_color: var(--color-albedo);
}

.nav-pill[data-phase="citrinitas"] {
  --neon_color: var(--color-citrinitas);
}

.nav-pill[data-phase="rubedo"] {
  --neon_color: var(--color-rubedo);
}

.nav-pill[data-phase="codex"] {
  --neon_color: var(--site_style_accent_alt);
}

#icon-user {
  @apply absolute left-1/2 z-40;
  @apply inline-flex items-center justify-center;
  @apply rounded-full;

  width: var(--center_ring_size);
  height: var(--center_ring_size);
  transform: translate3d(-50%, 0, 0);
}

#icon-user::before {
  content: "";

  @apply pointer-events-none absolute rounded-full;

  inset: -2px;
  padding: 2px;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    transparent 306deg,
    color-mix(in oklch, var(--site_style_accent) 22%, transparent) 321deg,
    color-mix(in oklch, var(--site_style_accent) 88%, transparent) 334deg,
    color-mix(in oklch, var(--site_style_accent) 44%, transparent) 342deg,
    transparent 350deg,
    transparent 360deg
  );
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0;
  filter: drop-shadow(
    0 0 8px color-mix(in oklch, var(--site_style_accent) 62%, transparent)
  );
}

#icon-user.is-route-active::before {
  opacity: 0.46;
}

#icon-user:hover::before,
#icon-user:focus-visible::before {
  opacity: 0.72;
  animation: icon_orbit_glow 2.2s cubic-bezier(0.34, 1.56, 0.64, 1) infinite;
}

#icon-user-shell {
  @apply absolute inset-0 overflow-hidden rounded-full;
  @apply border;

  border-color: var(--center_shell_border);
  background: radial-gradient(
    circle at 48% 30%,
    rgb(255 255 255 / 0.14),
    transparent 58%
  );
  box-shadow:
    0 0 26px -8px var(--center_shell_glow),
    inset 0 0 12px rgb(255 255 255 / 0.08);
}

#icon-user-shell-inner {
  @apply absolute inset-0 rounded-full;

  background: radial-gradient(
    circle,
    color-mix(in oklch, var(--center_shell_glow) 42%, transparent) 0%,
    transparent 72%
  );
}

.cinza_sun_halo,
.cinza_sun_highlight {
  @apply pointer-events-none absolute;

  /* display: none; */
}

#icon-user-core {
  @apply relative z-20 overflow-hidden rounded-full;
  @apply border;

  width: var(--center_core_size);
  height: var(--center_core_size);
  border-color: color-mix(
    in oklch,
    var(--center_shell_border) 42%,
    transparent
  );
  background-color: var(--center_core_background);
  box-shadow:
    0 0 0 1px rgb(255 255 255 / 0.04),
    0 0 20px -10px
      color-mix(in oklch, var(--center_shell_glow) 55%, transparent);
}

#icon-user-photo {
  @apply h-full w-full;

  object-fit: cover;
}

:root[data-site-theme="cinza"] #desktop-nav {
  --cinza_sun_tint: color-mix(in oklch, white 88%, var(--site_style_accent));
  --cinza_sun_neon_opacity: 0.94;
  --cinza_sun_halo_opacity: 0.82;
  --cinza_sun_highlight_opacity: 0.82;
  --cinza_sun_saturation: 1.2;
  --cinza_sun_contrast: 1.2;
  --center_shell_border: color-mix(
    in oklch,
    var(--site_style_accent) calc(34% * var(--site_style_strength_mult, 1)),
    transparent
  );
  --center_shell_glow: color-mix(
    in oklch,
    var(--site_style_accent) calc(42% * var(--site_shell_glow_mult, 1)),
    transparent
  );
  --center_core_background: color-mix(
    in oklch,
    var(--ui_bg_crust) calc(95% * var(--site_shell_surface_mult, 1)),
    transparent
  );
}

:root[data-site-theme="cinza"][data-site-shell="medium"] #desktop-nav {
  --cinza_sun_tint: color-mix(in oklch, white 90%, var(--site_style_accent));
  --cinza_sun_neon_opacity: 1;
  --cinza_sun_halo_opacity: 0.9;
  --cinza_sun_highlight_opacity: 0.94;
  --cinza_sun_saturation: 1.34;
  --cinza_sun_contrast: 1.3;
}

:root[data-site-theme="cinza"][data-site-shell="strong"] #desktop-nav {
  --cinza_sun_tint: color-mix(in oklch, white 94%, var(--site_style_accent));
  --cinza_sun_neon_opacity: 1;
  --cinza_sun_halo_opacity: 1;
  --cinza_sun_highlight_opacity: 1.04;
  --cinza_sun_saturation: 1.54;
  --cinza_sun_contrast: 1.52;
}

:root[data-site-theme="cinza"] #icon-user {
  isolation: isolate;
  filter: drop-shadow(
      0 0 26px rgb(255 255 255 / calc(0.32 * var(--site_fx_glow_mult, 1)))
    )
    drop-shadow(0 0 56px rgb(255 255 255 / 0.2));
}

:root[data-site-theme="cinza"] #icon-user-shell {
  overflow: visible;
}

:root[data-site-theme="cinza"] .cinza_sun_halo {
  width: 248%;
  height: 248%;
  border-radius: 50%;
  background: radial-gradient(
    circle,
    color-mix(in oklch, var(--cinza_sun_tint) 50%, transparent) 0 14%,
    color-mix(in oklch, var(--cinza_sun_tint) 26%, transparent) 34%,
    transparent 76%
  );
  opacity: calc(var(--cinza_sun_halo_opacity) * var(--cinza_sun_neon_opacity));
  z-index: 1;
  filter: blur(24px) saturate(var(--cinza_sun_saturation))
    contrast(var(--cinza_sun_contrast));
  mix-blend-mode: screen;
}

:root[data-site-theme="cinza"] #icon-user::before {
  opacity: 0;
  animation: none;
}

:root[data-site-theme="cinza"] #icon-user::after {
  content: none;
}

:root[data-site-theme="cinza"] .cinza_sun_halo,
:root[data-site-theme="cinza"] .cinza_sun_highlight {
  display: block;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 6;
}

:root[data-site-theme="cinza"] .cinza_sun_highlight {
  width: 105%;
  height: 105%;
  border-radius: 50%;
  border: 2px solid transparent;
  border-top-color: color-mix(in oklch, white 94%, var(--cinza_sun_tint));
  border-right-color: color-mix(in oklch, white 74%, var(--cinza_sun_tint));
  opacity: calc(
    var(--cinza_sun_highlight_opacity) * var(--cinza_sun_neon_opacity)
  );
  filter: blur(6px) saturate(var(--cinza_sun_saturation))
    contrast(var(--cinza_sun_contrast))
    drop-shadow(
      0 0 12px color-mix(in oklch, var(--cinza_sun_tint) 72%, transparent)
    )
    drop-shadow(
      0 0 24px color-mix(in oklch, var(--cinza_sun_tint) 44%, transparent)
    );
  mix-blend-mode: screen;
  animation: cinza_highlight_rotate 18s linear infinite;
}

:root[data-site-theme="cinza"] #icon-user:hover .cinza_sun_highlight,
:root[data-site-theme="cinza"] #icon-user:focus-visible .cinza_sun_highlight,
:root[data-site-theme="cinza"] #icon-user.is-route-active .cinza_sun_highlight {
  opacity: 1;
}

@media (max-width: 768px) {
  #desktop-nav {
    @apply hidden;
  }
}

@media (prefers-reduced-motion: reduce) {
  #desktop-nav {
    transition: none;
  }

  .nav-pill {
    transition: none;
  }

  #nav-user-bar::before {
    opacity: 0.6;
  }

  #icon-user:hover::before,
  #icon-user:focus-visible::before {
    animation: none;
  }

  #icon-user::after {
    animation: none;
  }

  .cinza_sun_halo,
  .cinza_sun_highlight {
    animation: none;
  }
}

@keyframes icon_orbit_glow {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

@keyframes icon_solar_breath {
  0%,
  100% {
    transform: scale(0.95);
    opacity: 0.28;
  }

  50% {
    transform: scale(1.06);
    opacity: 0.48;
  }
}

@keyframes cinza_highlight_rotate {
  from {
    transform: translate(-50%, -50%) rotate(0deg);
  }

  to {
    transform: translate(-50%, -50%) rotate(360deg);
  }
}
