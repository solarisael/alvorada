@reference "tailwindcss";
@import "./utils.css";
@reference "@catppuccin/tailwindcss/mocha.css";

/*
Ownership Matrix
- `theme` (`data-site-theme`): palette identity and motif language.
- `shell` (`data-site-shell`): container/surface structure intensity.
  - Owns: `--site_style_strength_mult`, `--site_style_blur`,
    `--site_shell_blur_mult`, `--site_shell_surface_mult`, `--site_shell_glow_mult`.
  - Also owns shell-facing decor intensity (for example gilded ornaments and
    home gate structural shadow depth).
- `fx` (`data-site-fx`): content emphasis intensity.
  - Owns: `--site_fx_glow_mult`, `--site_fx_motion_mult`, `--site_fx_lift_mult`.
  - Also owns non-shell interaction motion (for example hover lift and
    transition pacing on content/interactions).
*/
:root {
  --site_style_accent: var(--ui_accent);
  --site_style_accent_alt: var(--ui_accent_2);
  --site_style_shell_mix: 48%;
  --site_style_border_mix: 40%;
  --site_style_halo_mix: 18%;
  --site_style_edge_mix: 22%;
  --site_style_noise_opacity: 0.14;
  --site_style_deco_opacity: 0.22;
  --site_style_blur: 5px;
  --site_style_strength_mult: 1;
  --site_shell_blur_mult: 1;
  --site_shell_surface_mult: 1;
  --site_shell_glow_mult: 1;

  --site_fx_glow_mult: 1;
  --site_fx_motion_mult: 1;
  --site_fx_lift_mult: 1;

  --reading_plane_shift_y: 0px;

  /* Cinza quick tuning: master controls */
  --cinza_tune_axis_span: 0.5rem;
  --cinza_tune_rail_inline_offset: 0%;
  --cinza_tune_corner_scale: 1;
  --cinza_tune_line_block_size: clamp(1.18rem, 2.3vw, 1.76rem);
  --cinza_tune_sigil_size: clamp(2rem, 4.6vw, 3.25rem);
  --cinza_tune_rail_edge_nudge: 0.7rem;
  --cinza_tune_offset_up_mult: 1;
  --cinza_tune_offset_down_mult: 1;
  --cinza_tune_offset_left_mult: 1;
  --cinza_tune_offset_right_mult: 1;
  --cinza_tune_rails_in_content: 1;
  --cinza_tune_rails_in_stage: 0;
}

:root[data-site-theme="cinza"] {
  --site_style_accent: var(--ui_accent);
  --site_style_accent_alt: var(--ui_accent_2);
  --site_style_shell_mix: 48%;
  --site_style_border_mix: 44%;
  --site_style_halo_mix: 26%;
  --site_style_edge_mix: 36%;
  --site_style_noise_opacity: 0.1;
  --site_style_deco_opacity: 0.46;
  --cinza_reliquary_opacity: 0.88;
  --cinza_reliquary_line_mix: 40%;
  --cinza_reliquary_strong_mix: 62%;

  /* Away from border + vertical positioning */
  --cinza_reliquary_corner_scale: var(--cinza_tune_corner_scale);
  --cinza_reliquary_axis_offset: var(--cinza_tune_axis_span);
  --cinza_reliquary_offset_up_mult: var(--cinza_tune_offset_up_mult);
  --cinza_reliquary_offset_down_mult: var(--cinza_tune_offset_down_mult);
  --cinza_reliquary_offset_left_mult: var(--cinza_tune_offset_left_mult);
  --cinza_reliquary_offset_right_mult: var(--cinza_tune_offset_right_mult);
  --cinza_reliquary_offset_top: calc(
    var(--cinza_reliquary_axis_offset) * var(--cinza_reliquary_offset_up_mult)
  );
  --cinza_reliquary_offset_bottom: calc(
    var(--cinza_reliquary_axis_offset) * var(--cinza_reliquary_offset_down_mult)
  );
  --cinza_reliquary_offset_left: calc(
    var(--cinza_reliquary_axis_offset) * var(--cinza_reliquary_offset_left_mult)
  );
  --cinza_reliquary_offset_right: calc(
    var(--cinza_reliquary_axis_offset) *
      var(--cinza_reliquary_offset_right_mult)
  );
  --cinza_reliquary_axis_effective_span: calc(
    100% - var(--cinza_reliquary_offset_top) -
      var(--cinza_reliquary_offset_bottom)
  );
  --cinza_reliquary_axis_center: calc(
    (
        100% + var(--cinza_reliquary_offset_top) -
          var(--cinza_reliquary_offset_bottom)
      ) /
      2
  );

  /* Horizontal positioning */
  --cinza_reliquary_rail_inline_offset: var(--cinza_tune_rail_inline_offset);
  --cinza_reliquary_rail_left: calc(
    var(--cinza_reliquary_rail_inline_offset) *
      var(--cinza_reliquary_offset_left_mult)
  );
  --cinza_reliquary_rail_right: calc(
    100% -
      (
        var(--cinza_reliquary_rail_inline_offset) *
          var(--cinza_reliquary_offset_right_mult)
      )
  );

  /* Size */
  --cinza_reliquary_line_block_size: var(--cinza_tune_line_block_size);
  --cinza_reliquary_sigil_size: var(--cinza_tune_sigil_size);
  --cinza_reliquary_sigil_vertical_offset: var(--cinza_reliquary_sigil_size) *
    -0.5;
  --cinza_sun_bleed_mix: 34%;
  --cinza_sun_bleed_alt_mix: 24%;
  --cinza_fog_halo_mix: 30%;
  --cinza_fog_depth_mix: 20%;
  --cinza_fog_shadow_mix: 34%;
  --cinza_bw_saturation: 0.24;
  --cinza_bw_contrast: 1.16;
}

:root[data-site-theme="cinza"][data-site-shell="subtle"] {
  --site_style_deco_opacity: 0.38;
  --cinza_reliquary_opacity: 0.74;
  --cinza_reliquary_line_mix: 30%;
  --cinza_reliquary_strong_mix: 48%;
  --cinza_sun_bleed_mix: 24%;
  --cinza_sun_bleed_alt_mix: 16%;
  --cinza_fog_halo_mix: 18%;
  --cinza_fog_depth_mix: 14%;
  --cinza_fog_shadow_mix: 24%;
  --cinza_bw_saturation: 0.34;
  --cinza_bw_contrast: 1.08;
}

:root[data-site-theme="cinza"][data-site-shell="medium"] {
  --site_style_border_mix: 52%;
  --site_style_halo_mix: 31%;
  --site_style_edge_mix: 42%;
  --site_style_noise_opacity: 0.14;
  --site_style_deco_opacity: 0.52;
  --cinza_reliquary_opacity: 0.9;
  --cinza_reliquary_line_mix: 56%;
  --cinza_reliquary_strong_mix: 76%;
  --cinza_sun_bleed_mix: 42%;
  --cinza_sun_bleed_alt_mix: 28%;
  --cinza_fog_halo_mix: 40%;
  --cinza_fog_depth_mix: 24%;
  --cinza_fog_shadow_mix: 42%;
  --cinza_bw_saturation: 0.16;
  --cinza_bw_contrast: 1.26;
}

:root[data-site-theme="cinza"][data-site-shell="strong"] {
  --site_style_border_mix: 62%;
  --site_style_halo_mix: 37%;
  --site_style_edge_mix: 50%;
  --site_style_noise_opacity: 0.18;
  --site_style_deco_opacity: 0.62;
  --cinza_reliquary_opacity: 0.95;
  --cinza_reliquary_line_mix: 68%;
  --cinza_reliquary_strong_mix: 88%;
  --cinza_sun_bleed_mix: 50%;
  --cinza_sun_bleed_alt_mix: 36%;
  --cinza_fog_halo_mix: 52%;
  --cinza_fog_depth_mix: 34%;
  --cinza_fog_shadow_mix: 56%;
  --cinza_bw_saturation: 0.1;
  --cinza_bw_contrast: 1.34;
}

:root[data-site-shell="subtle"] {
  --site_style_strength_mult: 0.78;
  --site_style_blur: 3px;
  --site_shell_blur_mult: 0.84;
  --site_shell_surface_mult: 0.9;
  --site_shell_glow_mult: 0.84;
}

:root[data-site-shell="medium"] {
  --site_style_strength_mult: 1;
  --site_style_blur: 5px;
  --site_shell_blur_mult: 1;
  --site_shell_surface_mult: 1;
  --site_shell_glow_mult: 1;
}

:root[data-site-shell="strong"] {
  --site_style_strength_mult: 1.28;
  --site_style_blur: 8px;
  --site_shell_blur_mult: 1.22;
  --site_shell_surface_mult: 1.16;
  --site_shell_glow_mult: 1.22;
}

:root[data-site-fx="subtle"] {
  --site_fx_glow_mult: 0.8;
  --site_fx_motion_mult: 0.82;
  --site_fx_lift_mult: 0.72;
}

:root[data-site-fx="balanced"] {
  --site_fx_glow_mult: 1;
  --site_fx_motion_mult: 1;
  --site_fx_lift_mult: 1;
}

:root[data-site-fx="bold"] {
  --site_fx_glow_mult: 1.28;
  --site_fx_motion_mult: 1.18;
  --site_fx_lift_mult: 1.4;
}

.page-transition-breath-subtle {
  --page_fade_out_ms: 160ms;
  --page_fade_gap_ms: 60ms;
  --page_fade_in_ms: 220ms;
}

.page-transition-breath-noticeable {
  --page_fade_out_ms: 240ms;
  --page_fade_gap_ms: 20ms;
  --page_fade_in_ms: 180ms;
}

#content.htmx-request {
  animation-duration: calc(
    (
        var(--page_fade_out_ms) + var(--page_fade_gap_ms) +
          var(--page_fade_in_ms)
      ) *
      var(--site_fx_motion_mult)
  );
  animation-timing-function: linear;
}

::view-transition-group(page_content) {
  animation-duration: calc(
    (
        var(--page_fade_out_ms) + var(--page_fade_gap_ms) +
          var(--page_fade_in_ms)
      ) *
      var(--site_fx_motion_mult)
  );
  animation-timing-function: linear;
}

#content.htmx-swapping {
  animation-name: page_content_fade_out;
  animation-duration: calc(
    var(--page_fade_out_ms) * var(--site_fx_motion_mult)
  );
  animation-timing-function: cubic-bezier(0.4, 0, 1, 1);
  animation-fill-mode: both;
}

::view-transition-old(page_content) {
  animation-name: page_content_fade_out;
  animation-duration: calc(
    var(--page_fade_out_ms) * var(--site_fx_motion_mult)
  );
  animation-timing-function: cubic-bezier(0.4, 0, 1, 1);
  animation-fill-mode: both;
}

#content.htmx-added {
  animation-name: page_content_fade_in;
  animation-duration: calc(var(--page_fade_in_ms) * var(--site_fx_motion_mult));
  animation-delay: calc(var(--page_fade_gap_ms) * var(--site_fx_motion_mult));
  animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  animation-fill-mode: both;
}

::view-transition-new(page_content) {
  animation-name: page_content_fade_in;
  animation-duration: calc(var(--page_fade_in_ms) * var(--site_fx_motion_mult));
  animation-delay: calc(
    (var(--page_fade_out_ms) + var(--page_fade_gap_ms)) *
      var(--site_fx_motion_mult)
  );
  animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  animation-fill-mode: both;
}

@keyframes page_content_fade_out {
  from {
    opacity: 1;
  }

  to {
    opacity: 0;
  }
}

@keyframes page_content_fade_in {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

@media (prefers-reduced-motion: reduce) {
  :root {
    --reading_plane_shift_y: 0px;
  }

  ::view-transition-group(page_content),
  ::view-transition-old(page_content),
  ::view-transition-new(page_content) {
    animation-duration: 1ms;
    animation-delay: 0ms;
  }
}
