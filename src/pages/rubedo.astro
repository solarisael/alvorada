---
import IndexLayout from "../layouts/index.astro";
import { rubedo_book_map } from "../data/rubedo/book_timeline_runtime.js";

const sample_book_slugs = ["absurd-faith"];
---

<IndexLayout body_class="pov_cinza">
  <section aria-label="Rubedo scaffold">
    <article>
      <header>
        <p>~/ rubedo</p>
        <h1>Rubedo</h1>
      </header>

      <div>
        <p>
          Rubedo now includes a timeline/thread prototype. Canonical chapter
          order is deterministic, while thread view remains optional and
          reader-controlled.
        </p>

        {
          sample_book_slugs.map((book_slug) => (
            <div>
              <p>
                <a href={`/rubedo/${book_slug}`}>
                  Open book: {rubedo_book_map[book_slug]?.title ?? book_slug}
                </a>
              </p>
              {rubedo_book_map[book_slug]?.chapters?.[0] && (
                <p>
                  <a
                    href={`/rubedo/${book_slug}?chapter_id=${rubedo_book_map[book_slug].chapters[0].chapter_id}&thread_key=cinza&thread_modifier=core`}
                  >
                    Open reader at first canonical chapter
                  </a>
                </p>
              )}
              {rubedo_book_map[book_slug]?.chapters?.[0] && (
                <p>
                  <a
                    href={`/rubedo/${book_slug}/timeline?chapter_id=${rubedo_book_map[book_slug].chapters[0].chapter_id}&thread_key=cinza&thread_modifier=core`}
                  >
                    Open constellation timeline
                  </a>
                </p>
              )}
            </div>
          ))
        }
      </div>
    </article>
  </section>
</IndexLayout>
